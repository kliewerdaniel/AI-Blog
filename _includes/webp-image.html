{% comment %}
WebP-aware responsive image include file
Usage: 
{% include webp-image.html 
  src="path/to/image.jpg" 
  alt="Image description" 
  sizes="(max-width: 768px) 100vw, 50vw" 
  class="optional-class" 
%}
{% endcomment %}

{% assign base_path = include.src | split: '.' %}
{% assign file_name = base_path[0] %}
{% assign file_ext = base_path[1] %}

{% if page.permalink == '/about/' %}
<picture>
  <!-- WebP format for browsers that support it -->
  <source
    type="image/webp"
    srcset="
      {{ file_name }}-320.webp 320w,
      {{ file_name }}-640.webp 640w,
      {{ file_name }}-960.webp 960w,
      {{ file_name }}-1280.webp 1280w,
      {{ file_name }}.webp
    "
    sizes="{{ include.sizes | default: '(max-width: 768px) 100vw, 50vw' }}"
  >
  
  <!-- Original format for browsers that don't support WebP -->
  <source
    srcset="
      {{ file_name }}-320.{{ file_ext }} 320w,
      {{ file_name }}-640.{{ file_ext }} 640w,
      {{ file_name }}-960.{{ file_ext }} 960w,
      {{ file_name }}-1280.{{ file_ext }} 1280w,
      {{ include.src }}
    "
    sizes="{{ include.sizes | default: '(max-width: 768px) 100vw, 50vw' }}"
  >
  
  <!-- Fallback image for browsers that don't support picture element -->
  <img 
    src="{{ include.src }}" 
    alt="{{ include.alt }}"
    loading="lazy"
    {% if include.class %}class="{{ include.class }}"{% endif %}
  >
</picture>
{% else %}
<!-- Image hidden: Only showing images on About page -->
<span class="image-placeholder" aria-label="{{ include.alt }}"></span>
{% endif %}
